<!DOCTYPE html>
<html>
<head>
	<title>Remote USB Gamepad Client</title>
	<script>
		// Store all websockets in global array
		sockets = new Array()
		for (var i = 0; i < 2; i++) {
			console.log("Connecting to ws://localhost:" + (8000 + i))
			socket = new WebSocket('ws://localhost:' + (8000 + i));

			// Listen for messages
			socket.addEventListener('message', function (event) {
			    console.log('Message from server ', event.data);
			    display.innerHTML=event.data;
			});

			// Listen for socket closure
			socket.addEventListener('onclose', function (event) {
			    console.log("Socket " + (8000 + i) + " closed")
			});

			sockets.push(socket)
		}

		// Handler for when send button is clicked
		function on_send() {
			console.log("on_send")
			port_input = document.getElementById("port-number")
			message_input = document.getElementById("message")
			
			sockets[port_input.value].send(message_input.value)
		}
	</script>
</head>
<body>
	<label for="port-number">Port number:</label>
	<input type="number" id="port-number" name="port-number" min="0" max="1">
	<label for="message">Message:</label>
	<input type="text" id="message" name="message">
	<div id="display"></div>
	<button type="button" onclick="on_send()">Send</button>
</body>
</html>